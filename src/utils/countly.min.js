let Countly = {};
(function(V){var t="17.04";var c="javascript_native_web";var Z=false,s="https://xwfx.95579.com",J="",g="",P=false,am="",f=2000,H=1000,ad=[],A=[],Y=[],d={},X=[],l=null,k=true,ae,K=0,C=null,j=0,ab=0,W=0,ap=60,an=20,r=0,ah=60,T=10,ao=0,I=true,b,N=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,aj=/(CountlySiteBot|nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,m=true,q;function v(){S("https://api.map.baidu.com/getscript?v=2.0&ak=fYVlGt8Iaw3B3UWM4GrLgGWGz6i4Rb1U&s=1",function(aq){if(window.navigator.onLine){try{y("this.status","get location");var at=new BMap.LocalCity();at.get(function(av){J=av.name;var au=new BMap.Point(av.center.lng,av.center.lat);var aw=new BMap.Geocoder();aw.getLocation(au,function(ax){g=ax.addressComponents.province;y("this.status",g)});y("this.status",J+JSON.stringify(av))})}catch(ar){y("this.status","get location exception"+ar)}}else{alert("请检查您的网络是否通畅")}})}V.init=function(ar){if(!Z){v();q=D();Z=true;ad=e("cly_queue")||[];d={};A=e("cly_event")||[];ar=ar||{};f=ar.interval||V.interval||f;H=ar.queue_size||V.queue_size||H;ap=ar.fail_timeout||V.fail_timeout||ap;an=ar.inactivity_time||V.inactivity_time||an;ah=ar.session_update||V.session_update||ah;T=ar.max_events||V.max_events||T;V.ignore_prefetch=ar.ignore_prefetch||V.ignore_prefetch||true;V.debug=ar.debug||V.debug||false;V.app_key=ar.app_key||V.app_key||null;V.device_id=ar.device_id||V.device_id||ak();V.url=u(ar.url||s||"");V.app_version=ar.app_version||V.app_version||"0.0";V.country_code=ar.country_code||V.country_code||null;V.city=ar.city||V.city||null;V.city=ar.city||V.city||J||null;V.province=ar.province||V.province||g||null;V.ip_address=ar.ip_address||V.ip_address||null;V.ignore_bots=ar.ignore_bots||V.ignore_bots||true;V.force_post=ar.force_post||V.force_post||false;V.q=V.q||[["track_sessions"],["track_errors"],["track_pageview"]];V.onload=V.onload||[];V.ignore_visitor=ar.ignore_visitor||V.ignore_visitor||false;if(ar.ignore_referrers&&ar.ignore_referrers.constructor===Array){X=ar.ignore_referrers}else{if(V.ignore_referrers&&V.ignore_referrers.constructor===Array){X=V.ignore_referrers}}if(V.url===""){y("Please provide server URL");V.ignore_visitor=true}if(V.ignore_prefetch&&typeof document.visibilityState!=="undefined"&&document.visibilityState==="prerender"){V.ignore_visitor=true}if(V.ignore_bots&&aj.test(navigator.userAgent)){V.ignore_visitor=true}if(window.name&&window.name.indexOf("cly:")===0){V.passed_data=JSON.parse(window.name.replace("cly:",""))}else{if(location.hash&&location.hash.indexOf("#cly:")===0){V.passed_data=JSON.parse(location.hash.replace("#cly:",""))}}if(V.passed_data){if(V.passed_data.token&&V.passed_data.purpose){if(V.passed_data.token!=e("cly_old_token")){x(V.passed_data.token);e("cly_old_token",V.passed_data.token)}if(V.passed_data.purpose==="heatmap"){V.ignore_visitor=true;n();S(V.url+"/views/heatmap.js",G)}}}if(!V.ignore_visitor){y("Countly initialized");if(V.onload.constructor!==Array){V.onload=[]}if(V.q.constructor!==Array){V.q=[]}i();e("cly_id",V.device_id);if(location.search){var au=location.search.substring(1).split("&");for(var at=0;at<au.length;at++){var aq=au[at].split("=");if(aq[0]=="cly_id"){e("cly_cmp_id",aq[1])}else{if(aq[0]=="cly_uid"){e("cly_cmp_uid",aq[1])}}}}}}};V.begin_session=function(ar){if(!P){y("Session started");ae=D();P=true;k=(ar)?false:true;var aq={};aq.eventType=1;a(aq)}};V.session_duration=function(aq){if(P){}};V.end_session=function(aq){if(P){aq=aq||D()-ae;y("Ending session");M();P=false;a({eventType:0,sessionDuration:aq})}};V.change_id=function(aq,at){if(V.device_id!=aq){if(!at){V.end_session();d={}}var ar=V.device_id;V.device_id=aq;e("cly_id",V.device_id);y("Changing id");if(at){a({old_device_id:ar})}else{V.begin_session(!k)}}};V.add_event=function(ar){if(!ar.eventId){y("Event must have eventId property");return}var aq=["fromPageId","eventId","toPageId","pageDuration","udfParams"];var at=U(ar,aq);at.timestamp=Q();A.push(at);e("cly_event",A);if(A.length>=T){i(true)}y("Adding event: ",ar)};V.setAccount=function(aq){V.account=aq};V.start_event=function(aq){if(d[aq]){y("Timed event with key "+aq+" already started");return}d[aq]=D()};V.end_event=function(aq){if(typeof aq=="string"){aq={eventId:aq}}if(!aq.key){y("Event must have key property");return}if(!d[aq.key]){y("Timed event with key "+aq.eventId+" was not started");return}aq.pageDuration=D()-d[aq.eventId];V.add_event(aq);delete d[aq.eventId]};V.user_details=function(aq){y("Adding userdetails: ",aq);var ar=["name","username","email","organization","phone","picture","gender","byear","custom"];a({user_details:JSON.stringify(U(aq,ar))})};V.report_conversion=function(aq,ar){aq=aq||e("cly_cmp_id")||"cly_organic";ar=ar||e("cly_cmp_uid");if(aq&&ar){a({campaign_id:aq,campaign_user:ar})}else{if(aq){a({campaign_id:aq})}else{y("No campaign data found")}}};var al={};var aa=function(ar,at,aq){if(!al[ar]){al[ar]={}}if(aq=="$push"||aq=="$pull"||aq=="$addToSet"){if(!al[ar][aq]){al[ar][aq]=[]}al[ar][aq].push(at)}else{al[ar][aq]=at}};V.userData={set:function(aq,ar){al[aq]=ar},set_once:function(aq,ar){aa(aq,1,"$setOnce")},increment:function(aq){aa(aq,1,"$inc")},increment_by:function(aq,ar){aa(aq,ar,"$inc")},multiply:function(aq,ar){aa(aq,ar,"$mul")},max:function(aq,ar){aa(aq,ar,"$max")},min:function(aq,ar){aa(aq,ar,"$min")},push:function(aq,ar){aa(aq,ar,"$push")},push_unique:function(aq,ar){aa(aq,ar,"$addToSet")},pull:function(aq,ar){aa(aq,ar,"$pull")},save:function(){a({user_details:JSON.stringify({custom:al})});al={}}};V.track_errors=function(aq){l=aq;window.onerror=function(at,ar,aA,au,av){if(typeof av!=="undefined"){ac(av,false)}else{au=au||(window.event&&window.event.errorCharacter);var ay="";if(typeof at!=="undefined"){ay+=at+"\n"}if(typeof ar!=="undefined"){ay+="at "+ar}if(typeof aA!=="undefined"){ay+=":"+aA}if(typeof au!=="undefined"){ay+=":"+au}ay+="\n";try{var az=[];var aw=arguments.caller.caller;while(aw){az.push(aw.name);aw=aw.caller}ay+=az.join("\n")}catch(ax){}ac(ay,false)}}};V.log_error=function(ar,aq){ac(ar,true,aq)};V.add_log=function(aq){Y.push(aq)};V.stop_time=function(){if(m){m=false;K=D()-ae;ab=D()-j}};V.start_time=function(){if(!m){m=true;ae=D()-K;j=D()-ab;ab=0}};V.track_sessions=function(){V.begin_session();V.start_time();O(window,"beforeunload",function(){V.end_session()});O(window,"unload",function(){V.end_session()});var ar="hidden";function aq(){if(document[ar]){V.stop_time()}else{V.start_time()}}if(ar in document){document.addEventListener("visibilitychange",aq)}else{if((ar="mozHidden") in document){document.addEventListener("mozvisibilitychange",aq)}else{if((ar="webkitHidden") in document){document.addEventListener("webkitvisibilitychange",aq)}else{if((ar="msHidden") in document){document.addEventListener("msvisibilitychange",aq)}else{if("onfocusin" in document){O(window,"focusin",function(){V.start_time()});O(window,"focusout",function(){V.stop_time()})}else{O(window,"focus",function(){V.start_time()});O(window,"blur",function(){V.stop_time()});O(window,"pageshow",function(){V.start_time()});O(window,"pagehide",function(){V.stop_time()})}}}}}function at(){if(r>=an){V.start_time()}r=0}O(window,"mousemove",at);O(window,"click",at);O(window,"keydown",at);O(window,"scroll",at);setInterval(function(){r++;if(r>=an){V.stop_time()}},60000)};V.track_pageview=function(ax,ar){M();if(ax&&ax.constructor===Array){ar=ax;ax=null}var aw=sessionStorage.getItem("countly_last_page");if(aw==undefined){aw=""}var az;if(document.getElementsByTagName("body")[0]!=undefined){az=document.getElementsByTagName("body")[0].countly_page_id}ax=ax||az||window.location.pathname;if(ar&&ar.length){for(var au=0;au<ar.length;au++){try{var aq=new RegExp(ar[au]);if(aq.test(ax)){y("Ignored:",ax);return}}catch(ay){}}}C=ax;j=D();var at={name:ax,visit:1,domain:window.location.hostname};if(typeof document.referrer!=="undefined"&&document.referrer.length){var av=N.exec(document.referrer);if(av&&av[11]&&av[11]!=window.location.hostname){at.start=1}}V.add_event({fromPageId:aw,toPageId:ax,eventId:"scChangePage"});sessionStorage.setItem("countly_last_page",ax)};V.track_view=function(ar,aq){V.track_pageview(ar,aq)};V.track_clicks=function(ar){ar=ar||document;var at=true;function aq(aw){if(at){at=false;z(aw);if(typeof aw.pageX!=="undefined"&&typeof aw.pageY!=="undefined"){var au=o();var av=af();V.add_event({key:"[CLY]_action",udfParams:{type:"click",x:aw.pageX,y:aw.pageY,width:av,height:au,domain:window.location.hostname}})}setTimeout(function(){at=true},1000)}}O(ar,"click",aq)};V.track_links=function(ar){ar=ar||document;function aq(av){var au=h(av).closest("a");if(au){z(av);V.add_event({key:"linkClick",udfParams:{href:au.href,text:au.innerText,id:au.id,x:av.pageX,y:av.pageY}});if(typeof au.href!=="undefined"&&au.target!=="_blank"&&!(av.metaKey||av.altKey||av.ctrlKey||av.shiftKey)){var at=au.href.replace(window.location.href.split("#")[0],"");if(at.indexOf("#")!==0){V.end_session()}}}}O(ar,"click",aq)};V.track_forms=function(ar){ar=ar||document;function aq(au){return au.name||au.id||au.type||au.nodeName}function at(aB){var aA=h(aB);var au={id:aA.id,name:aA.name,action:aA.action,method:aA.method};var aw;if(typeof aA.elements!=="undefined"){for(var az=0;az<aA.elements.length;az++){aw=aA.elements[az];if(aw&&aw.type!="password"){if(typeof au["input:"+aq(aw)]==="undefined"){au["input:"+aq(aw)]=[]}if(aw.nodeName.toLowerCase()=="select"){if(typeof aw.multiple!=="undefined"){var av=[];if(typeof aw.options!=="undefined"){for(var ax=0;ax<aw.options.length;ax++){if(aw.options[ax].selected){av.push(aw.options[ax].value)}}}au["input:"+aq(aw)].push(av.join(", "))}else{au["input:"+aq(aw)].push(aw.options[aw.selectedIndex].value)}}else{if(aw.nodeName.toLowerCase()=="input"){if(typeof aw.type!=="undefined"){if(aw.type.toLowerCase()=="checkbox"||aw.type.toLowerCase()=="radio"){if(aw.checked){au["input:"+aq(aw)].push(aw.value)}}else{au["input:"+aq(aw)].push(aw.value)}}else{au["input:"+aq(aw)].push(aw.value)}}else{if(aw.nodeName.toLowerCase()=="textarea"){au["input:"+aq(aw)].push(aw.value)}else{if(typeof aw.value!=="undefined"){au["input:"+aq(aw)].push(aw.value)}}}}}}}for(var ay in au){if(typeof au[ay].join!="undefined"){au[ay]=au[ay].join(", ")}}V.add_event({key:"formSubmit",udfParams:au});V.end_session()}O(ar,"submit",at)};V.collect_from_forms=function(ar,aq){ar=ar||document;function at(au){var av=h(au);var aC={};var aw=false;var aD;if(typeof av.elements!=="undefined"){var aB={};var aA=ar.getElementsByTagName("LABEL");var az,ay;for(az=0;az<aA.length;az++){if(aA[az].htmlFor&&aA[az].htmlFor!==""){aB[aA[az].htmlFor]=aA[az].innerText||aA[az].textContent||aA[az].innerHTML}}for(az=0;az<av.elements.length;az++){aD=av.elements[az];if(aD&&aD.type!="password"){if(aD.className.indexOf("cly_user_ignore")==-1){var aE="";if(aD.nodeName.toLowerCase()=="select"){if(typeof aD.multiple!=="undefined"){var aF=[];if(typeof aD.options!=="undefined"){for(ay=0;ay<aD.options.length;ay++){if(aD.options[ay].selected){aF.push(aD.options[ay].value)}}}aE=aF.join(", ")}else{aE=aD.options[aD.selectedIndex].value}}else{if(aD.nodeName.toLowerCase()=="input"){if(typeof aD.type!=="undefined"){if(aD.type.toLowerCase()=="checkbox"||aD.type.toLowerCase()=="radio"){if(aD.checked){aE=aD.value}}else{aE=aD.value}}else{aE=aD.value}}else{if(aD.nodeName.toLowerCase()=="textarea"){aE=aD.value}else{if(typeof aD.value!=="undefined"){aE=aD.value}}}}if(aD.className&&aD.className.indexOf("cly_user_")!=-1){var ax=aD.className.split(" ");for(ay=0;ay<ax.length;ay++){if(ax[ay].indexOf("cly_user_")===0){aC[ax[ay].replace("cly_user_","")]=aE;aw=true;break}}}else{if((aD.type&&aD.type.toLowerCase()=="email")||(aD.name&&aD.name.toLowerCase().indexOf("email")!=-1)||(aD.id&&aD.id.toLowerCase().indexOf("email")!=-1)||(aD.id&&aB[aD.id]&&aB[aD.id].toLowerCase().indexOf("email")!=-1)||(/[^@\s]+@[^@\s]+\.[^@\s]+/).test(aE)){if(!aC.email){aC.email=aE}aw=true}else{if((aD.name&&aD.name.toLowerCase().indexOf("username")!=-1)||(aD.id&&aD.id.toLowerCase().indexOf("username")!=-1)||(aD.id&&aB[aD.id]&&aB[aD.id].toLowerCase().indexOf("username")!=-1)){if(!aC.username){aC.username=aE}aw=true}else{if((aD.name&&(aD.name.toLowerCase().indexOf("tel")!=-1||aD.name.toLowerCase().indexOf("phone")!=-1||aD.name.toLowerCase().indexOf("number")!=-1))||(aD.id&&(aD.id.toLowerCase().indexOf("tel")!=-1||aD.id.toLowerCase().indexOf("phone")!=-1||aD.id.toLowerCase().indexOf("number")!=-1))||(aD.id&&aB[aD.id]&&(aB[aD.id].toLowerCase().indexOf("tel")!=-1||aB[aD.id].toLowerCase().indexOf("phone")!=-1||aB[aD.id].toLowerCase().indexOf("number")!=-1))){if(!aC.phone){aC.phone=aE}aw=true}else{if((aD.name&&(aD.name.toLowerCase().indexOf("org")!=-1||aD.name.toLowerCase().indexOf("company")!=-1))||(aD.id&&(aD.id.toLowerCase().indexOf("org")!=-1||aD.id.toLowerCase().indexOf("company")!=-1))||(aD.id&&aB[aD.id]&&(aB[aD.id].toLowerCase().indexOf("org")!=-1||aB[aD.id].toLowerCase().indexOf("company")!=-1))){if(!aC.organization){aC.organization=aE}aw=true}else{if((aD.name&&aD.name.toLowerCase().indexOf("name")!=-1)||(aD.id&&aD.id.toLowerCase().indexOf("name")!=-1)||(aD.id&&aB[aD.id]&&aB[aD.id].toLowerCase().indexOf("name")!=-1)){if(!aC.name){aC.name=""}aC.name+=aE+" ";aw=true}}}}}}}}}}if(aw){y("Gathered user data",aC);if(aq){V.user_details({custom:aC})}else{V.user_details(aC)}}V.end_session()}O(ar,"submit",at)};V.collect_from_facebook=function(aq){if(FB&&FB.api){FB.api("/me",function(ax){var av={};if(ax.name){av.name=ax.name}if(ax.email){av.email=ax.email}if(ax.gender=="male"){av.gender="M"}else{if(ax.gender=="female"){av.gender="F"}}if(ax.birthday){var ay=ax.birthday.split("/").pop();if(ay&&ay.length==4){av.byear=ay}}if(ax.work&&ax.work[0]&&ax.work[0].employer&&ax.work[0].employer.name){av.organization=ax.work[0].employer.name}if(aq){av.custom={};for(var au in aq){var aw=aq[au].split(".");var at=ax;for(var ar=0;ar<aw.length;ar++){at=at[aw[ar]];if(typeof at==="undefined"){break}}if(typeof at!=="undefined"){av.custom[au]=at}}}V.user_details(av)})}};function M(){if(C){var aq={name:C,segment:b};V.add_event({key:"[CLY]_view",dur:D()-j,udfParams:aq});C=null}}function p(){return C}function a(aq){if(V.ignore_visitor){return}if(!V.app_key||!V.device_id){y("app_key or device_id is missing");return}if(V.account){aq.userId=V.account}aq.guid=V.device_id;aq.platform=ag();aq.platformVersion=ai();aq.container=V.app_key;aq.containerVersion=V.app_version;aq.deviceType=R()[0];aq.resolution=w._resolution;aq.carrier=V.app_key;aq.carrier="";aq.sbmNum=V.sbmNum||"";aq.sendTimestamp=Q();aq.network=V.app_key;if(V.country_code){aq.province=V.country_code}aq.network="";if(g){aq.province=g}if(V.city){aq.city=V.city}if(J){aq.city=J}if(ad.length>H){ad.shift()}ad.push(aq);e("cly_queue",ad,true)}function i(av){y("heartBeat:requestQueue==="+ad.length);if(V.ignore_visitor){return}var au=0;if(typeof V.onload!=="undefined"&&V.onload.length>0){for(au=0;au<V.onload.length;au++){if(typeof V.onload[au]==="function"){V.onload[au]()}}V.onload=[]}if(typeof V.q!=="undefined"&&V.q.length>0){var aw;var aq=V.q;V.q=[];for(au=0;au<aq.length;au++){aw=aq[au];y("Processing queued call",aw);if(typeof aw==="function"){aw()}else{if(aw.constructor===Array&&aw.length>0){if(typeof V[aw[0]]!=="undefined"){V[aw[0]].apply(null,aw.slice(1))}else{var ax=aw[0].replace("userData.","");if(typeof V.userData[ax]!=="undefined"){V.userData[ax].apply(null,aw.slice(1))}}}}}}if(P&&k&&m){var ay=D();if(ay-ae>ah){V.session_duration(ay-ae);ae=ay}}if(A.length>0){if(A.length<T){a({eventType:2,events:A});A=[]}else{var az=A.splice(0,T);a({eventType:2,events:az})}e("cly_event",A)}var ar=f;if(ad.length>0&&I&&D()>W){var at=ad.shift();while(at==undefined||at===false||at===true){at=ad.shift()}I=false;F(at,function(aA,aB){y(aA?"失败":"成功===="+JSON.stringify(aB));if(aA){ad.unshift(aB);W=D()+ap}e("cly_queue",ad,true);I=true})}if(av){return}setTimeout(i,f)}function ak(){return e("cly_id")||L()}function L(){var ar=new Date().getTime();var aq="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(au){var at=(ar+Math.random()*16)%16|0;ar=Math.floor(ar/16);return(au=="x"?at:(at&3|8)).toString(16)});return aq}function R(){var av=navigator.userAgent.toLowerCase();var aw=/msie [\d.]+;/gi;var at=/firefox\/[\d.]+/gi;var ar=/chrome\/[\d.]+/gi;var au=/safari\/[\d.]+/gi;var aq=[];if(av.indexOf("msie")>0){aq=av.match(aw)}if(av.indexOf("firefox")>0){aq=av.match(at)}if(av.indexOf("chrome")>0){aq=av.match(ar)}if(av.indexOf("safari")>0&&av.indexOf("chrome")<0){aq=av.match(au)}if(aq&&aq.length>0){return aq}else{return["web"]}}function ag(){var av=navigator.userAgent;var ax=(navigator.platform=="Win32")||(navigator.platform=="Windows");var ay=(navigator.platform=="Mac68K")||(navigator.platform=="MacPPC")||(navigator.platform=="Macintosh")||(navigator.platform=="MacIntel");if(ay){return"Mac"}var au=(navigator.platform=="X11")&&!ax&&!ay;if(au){return"Unix"}var at=(String(navigator.platform).indexOf("Linux")>-1);var aq=av.toLowerCase().match(/android/i)=="android";if(at){if(aq){return"Android"}else{return"Linux"}}if(ax){var aw=av.indexOf("Windows NT 5.0")>-1||av.indexOf("Windows 2000")>-1;if(aw){return"Win2000"}var aC=av.indexOf("Windows NT 5.1")>-1||av.indexOf("Windows XP")>-1;av.indexOf("Windows XP")>-1;if(aC){return"WinXP"}var ar=av.indexOf("Windows NT 5.2")>-1||av.indexOf("Windows 2003")>-1;if(ar){return"Win2003"}var aA=av.indexOf("Windows NT 6.0")>-1||av.indexOf("Windows Vista")>-1;if(aA){return"WinVista"}var aB=av.indexOf("Windows NT 6.1")>-1||av.indexOf("Windows 7")>-1;if(aB){return"Win7"}var az=av.indexOf("windows nt6.2")>-1||av.indexOf("Windows 8")>-1;if(az){return"Win8"}}return"other"}function ai(){var ar=navigator.userAgent.toLowerCase();var aq=navigator.userAgent;var aq=navigator.userAgent;var at=aq.indexOf("WOW64")>-1;if(at){return"64bit"}else{return"32bit"}}function w(){var ax={};ax._app_version=V.app_version;ax._ua=navigator.userAgent;if(screen.width){var aq=(screen.width)?parseInt(screen.width):0;var aB=(screen.height)?parseInt(screen.height):0;if(aq!==0&&aB!==0){var ay=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(ay&&window.devicePixelRatio){aq=Math.round(aq*window.devicePixelRatio);aB=Math.round(aB*window.devicePixelRatio)}else{if(Math.abs(window.orientation)===90){var aA=aq;aq=aB;aB=aA}}ax._resolution=""+aq+"x"+aB}}if(window.devicePixelRatio){ax._density=window.devicePixelRatio}var az=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(typeof az!=="undefined"){ax._locale=az}if(typeof document.referrer!=="undefined"&&document.referrer.length){var au=N.exec(document.referrer);if(au&&au[11]&&au[11]!=window.location.hostname){var av=false;if(X&&X.length){for(var at=0;at<X.length;at++){try{var ar=new RegExp(X[at]);if(ar.test(document.referrer)){y("Ignored:",document.referrer);av=true;break}}catch(aw){}}}if(!av){ax._store=document.referrer}}}y("Got metrics",ax);return ax}function y(){if(V.debug&&typeof console!=="undefined"){if(arguments[1]&&typeof arguments[1]=="object"){arguments[1]=JSON.stringify(arguments[1])}console.log(Array.prototype.slice.call(arguments).join("\n"))}}function D(){return Math.floor(new Date().getTime()/1000)}function Q(){var aq=new Date().getTime();if(ao>=aq){ao++}else{ao=aq}return ao}function ac(at,aA,av){if(at){av=av||l;var az="";if(typeof at==="object"){if(typeof at.stack!=="undefined"){az=at.stack}else{if(typeof at.name!=="undefined"){az+=at.name+":"}if(typeof at.message!=="undefined"){az+=at.message+"\n"}if(typeof at.fileName!=="undefined"){az+="in "+at.fileName+"\n"}if(typeof at.lineNumber!=="undefined"){az+="on "+at.lineNumber}if(typeof at.columnNumber!=="undefined"){az+=":"+at.columnNumber}}}else{az=at+""}aA=(aA)?true:false;var ay=w();var aq={_resolution:ay._resolution,_error:az,_app_version:ay._app_version,_run:D()-q};aq._not_os_specific=true;var aw=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;if(aw){aq._bat=Math.floor(aw.level*100)}if(typeof navigator.onLine!=="undefined"){aq._online=(navigator.onLine)?true:false}aq._background=(document.hasFocus())?false:true;if(Y.length>0){aq._logs=Y.join("\n")}Y=[];aq._nonfatal=aA;aq._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||"");if(typeof av!=="undefined"){aq._custom=av}try{var ar=document.createElement("canvas");var au=ar.getContext("experimental-webgl");aq._opengl=au.getParameter(au.VERSION)}catch(ax){}a({eventType:3,dumpLog:JSON.stringify(aq)})}}function F(au,aw){try{var at=window.XMLHttpRequest?new window.XMLHttpRequest():window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;var aq=E(au);if(aq.length==0){return}y("send_param========="+V.url+JSON.stringify(au));var av="POST";if(av==="GET"){at.open("GET",V.url+am+"?"+aq,true)}else{at.open("POST",V.url+am,true);at.setRequestHeader("Content-type","application/json;charset=utf-8")}at.onreadystatechange=function(){if(this.status==200||this.status===400){if(typeof aw==="function"){aw(false,au)}}else{if(typeof aw==="function"){aw(true,au)}}};if(av=="GET"){at.send()}else{at.send(JSON.stringify(au))}}catch(ar){y("Failed XML HTTP request",ar);if(typeof aw==="function"){aw(false,au)}}}function E(at){var ar=[];for(var aq in at){ar.push(aq+"="+at[aq])}return ar.join("&")}function u(aq){if(aq.substr(aq.length-1)=="/"){return aq.substr(0,aq.length-1)}return aq}function U(av,at){var aq={};var au;for(var ar=0;ar<at.length;ar++){au=at[ar];if(typeof av[au]!=="undefined"){if(au=="udfParams"){aq[au]=JSON.stringify(av[au])}else{aq[au]=av[au]}}}return aq}if(!Element.prototype.closest){Element.prototype.closest=function(ar){var aq=this;ar=ar.toUpperCase();while(aq){if(aq.nodeName.toUpperCase()==ar){return aq}aq=aq.parentElement}}}var O=function(aq,ar,at){if(typeof aq.addEventListener!=="undefined"){aq.addEventListener(ar,at,false)}else{aq.attachEvent("on"+ar,at)}};var h=function(aq){if(!aq){return window.event.srcElement}else{if(typeof aq.target!=="undefined"){return aq.target}else{return aq.srcElement}}};function z(aq){if(typeof aq.pageY=="undefined"&&typeof aq.clientX=="number"&&document.documentElement){aq.pageX=aq.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;aq.pageY=aq.clientY+document.body.scrollTop+document.documentElement.scrollTop}return aq}function o(){var aq=document;return Math.max(Math.max(aq.body.scrollHeight,aq.documentElement.scrollHeight),Math.max(aq.body.offsetHeight,aq.documentElement.offsetHeight),Math.max(aq.body.clientHeight,aq.documentElement.clientHeight))}function af(){var aq=document;return Math.max(Math.max(aq.body.scrollWidth,aq.documentElement.scrollWidth),Math.max(aq.body.offsetWidth,aq.documentElement.offsetWidth),Math.max(aq.body.clientWidth,aq.documentElement.clientWidth))}function x(aq){e("cly_token",aq)}function B(){var aq=e("cly_token");e("cly_token",null);return aq}var e=function e(at,aw,ar){ar=ar||false;var au=false,av;if(typeof localStorage!=="undefined"){au=true;try{localStorage.setItem("testLocal",true)}catch(ay){au=false}}if(typeof aw!=="undefined"&&aw!==null){if(typeof aw==="object"){aw=JSON.stringify(aw)}if(au){localStorage.setItem(at,aw)}else{if(!ar){aq(at,aw,30)}}}if(typeof aw==="undefined"){if(au){av=localStorage.getItem(at)}else{if(!ar){av=ax(at)}}try{av=JSON.parse(av)}catch(ay){av=av}return av}if(aw===null){if(au){localStorage.removeItem(at)}else{if(!ar){aq(at,"",-1)}}}function aq(aB,aC,aD){var aA=new Date();aA.setTime(aA.getTime()+(aD*24*60*60*1000));var az="; expires="+aA.toGMTString();document.cookie=aB+"="+aC+az+"; path=/"}function ax(aC){var aD=aC+"=";var aA=document.cookie.split(";");for(var aB=0,az=aA.length;aB<az;aB++){var aE=aA[aB];while(aE.charAt(0)===" "){aE=aE.substring(1,aE.length)}if(aE.indexOf(aD)===0){return aE.substring(aD.length,aE.length)}}return null}};function S(at,au){var ar=document.createElement("script"),aq;ar.setAttribute("type","text/javascript");ar.setAttribute("src",at);if(au){ar.onreadystatechange=ar.onload=function(){if(!aq){au()}aq=true}}document.getElementsByTagName("head")[0].appendChild(ar)}function n(){var aq=document.getElementById("cly-loader");if(!aq){y("setting up loader");var at="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",ar=document.head||document.getElementsByTagName("head")[0],au=document.createElement("style");au.type="text/css";if(au.styleSheet){au.styleSheet.cssText=at}else{au.appendChild(document.createTextNode(at))}ar.appendChild(au);aq=document.createElement("div");aq.setAttribute("id","cly-loader");document.body.appendChild(aq)}aq.style.display="block"}function G(){var aq=document.getElementById("cly-loader");if(aq){aq.style.display="none"}}V._internals={store:e,getDocWidth:af,getDocHeight:o,get_page_coord:z,get_event_target:h,getProperties:U,stripTrailingSlash:u,prepareParams:E,sendXmlHttpRequest:F,recordError:ac,getMsTimestamp:Q,getTimestamp:D,log:y,getMetrics:w,generateUUID:L,getId:ak,heartBeat:i,toRequestQueue:a,reportViewDuration:M,loadJS:S,getLastView:p,setToken:x,getToken:B,showLoader:n,hideLoader:G}}(Countly));
export default Countly;